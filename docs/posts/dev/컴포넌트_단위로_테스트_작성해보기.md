# ì»´í¬ë„ŒíŠ¸ ë‹¨ìœ„ë¡œ í…ŒìŠ¤íŠ¸ ì‘ì„±í•´ë³´ê¸°

## ë°°ê²½

ì´ì „ ë‹´ë‹¹í–ˆë˜ í”„ë¡œì íŠ¸ì—ëŠ” íŠ¹ì • ì¹´íƒˆë¡œê·¸ì˜ ì„¸ë¶€ì •ë³´ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•œ ì¹´íƒˆë¡œê·¸ ìƒì„¸í˜ì´ì§€ê°€ ìˆì—ˆëŠ”ë°, ì‹¬ì§€ì–´ ì „ íŒ€ì¥ë‹˜ë„ "ìˆ¨ì´ ì£½ì–´ê°€ëŠ” í˜ì´ì§€"ë¼ê³  í•˜ì‹¤ ì •ë„ë¡œ êµ¬í˜„ì´ ë³µì¡í•˜ê¸°ë¡œ ì•…ëª…ë†’ì•˜ìŠµë‹ˆë‹¤ğŸ˜¨

ì–´ëŠ ë‚ , ì•„ì¹¨ ìŠ¤í¬ëŸ¼ ë•Œ ì „ íŒ€ì¥ë‹˜ì´ ìƒì„¸í˜ì´ì§€ì— ë¦¬íŒ©í† ë§ì„ ì§„í–‰í•  í•„ìš”ê°€ ìˆë‹¤ê³  ì–¸ê¸‰í•˜ì‹œë©´ì„œ ë§ˆì§€ë§‰ì— "ë‹¨ìœ„ í…ŒìŠ¤íŠ¸" ì½”ë“œê°€ ìˆìœ¼ë©´ ì¢‹ê² ë‹¤ê³  í•˜ì…¨ìŠµë‹ˆë‹¤.

í”„ë¡œì íŠ¸ì— í•©ë¥˜í–ˆë˜ ì´ˆì°½ê¸°ì— ìƒì„¸í˜ì´ì§€ ì†ŒìŠ¤ë¥¼ ì´ë¦¬ì €ë¦¬ ë¶„ì„í•˜ë©´ì„œ í˜ê²¨ìš´ ì‹ ê³ ì‹(?)ì„ ê±°ì³¤ë˜ ì–´ëŠ ì£¼ë‹ˆì–´ ê°œë°œìëŠ” ì´ ë§ì„ ë“£ê³  ì‹¹ ê°ˆì•„ì—ê² ë‹¤ëŠ” ì—„ì²­ë‚œ íŒ¨ê¸°ë¡œ ì—­í• ë¶„ë‹´ íšŒì˜ë¥¼ í•˜ê¸°ë„ ì „ì— ë°”ë¡œ ì§€ë¼ í‹°ì¼“ì„ ë§Œë“¤ì–´ ë²„ë¦½ë‹ˆë‹¤.

ë„¤, ê·¸ê²Œ ë°”ë¡œ ì €ì˜€ìŠµë‹ˆë‹¤.

![Refactoring](./images/refactoring.jpeg)

3ë²ˆì˜ ë¦¬ë·°íšŒì˜ë¥¼ ê±°ì¹˜ë©´ì„œ ê°œë°œë°©í–¥ì„ ê°€ë‹¤ë“¬ê³  ì‘ì—…ì„ ì§„í–‰í–ˆì§€ë§Œ ì›Œë‚™ ê¸´ íˆìŠ¤í† ë¦¬ë¥¼ ê°€ì§„ ë³µì¡í•œ ì •ì±…ê³¼ ì´ˆë°˜ì— ì„¸ìš´ ë¬´ë¦¬í•œ ì‘ì—…ê³„íš, ê·¸ë¦¬ê³  ë‹¹ì‹œ íŒ€ì¥ë‹˜ì´ ë‹¤ë¥¸ ê³³ìœ¼ë¡œ ì´ì§í•˜ì‹œë©´ì„œ ì‚¬ì‹¤ìƒ ì¤‘ë‹¨ë˜ê³  ë§ì•˜ìŠµë‹ˆë‹¤.

ë¹„ë¡ ë§ˆë¬´ë¦¬ë¥¼ ì§“ì§€ëŠ” ëª»í–ˆì§€ë§Œ ì¬ì‚¬ìš©ì´ ìš©ì´í•œ ì»´í¬ë„ŒíŠ¸ì˜ êµ¬ì¡°ì™€ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ ê³ ë¯¼í•  ìˆ˜ ìˆì—ˆë˜ ê²½í—˜ìœ¼ë¡œ ê¸°ì–µì— ë‚¨ì•„ì„œ í•œë²ˆ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•˜ê¸°ê¹Œì§€ì˜ ê³¼ì •ê³¼ ëŠë‚€ì ë“¤ì„ ì •ë¦¬í•˜ê³ ì í•©ë‹ˆë‹¤.

## ì»´í¬ë„ŒíŠ¸ ì„¤ê³„

ìƒì„¸í˜ì´ì§€ ì¼ë¶€ì™€ ì»´í¬ë„ŒíŠ¸ ë‹¨ìœ„ë¡œ ë‚˜ëˆŒ ì˜ì—­ì„ í‘œì‹œí•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

![Detail Page](./images/detail_page.png)

ë‚˜ë‰˜ì–´ì§„ ì»´í¬ë„ŒíŠ¸ë“¤ì„ í…ŒìŠ¤íŠ¸ ë‹¨ìœ„ë¡œ ì •í–ˆëŠ”ë° ì´ìœ ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.

1. ìƒì„¸í˜ì´ì§€ ì „ì²´ í…ŒìŠ¤íŠ¸ë¥¼ ë‚´ë¶€ ì»´í¬ë„ŒíŠ¸ë“¤ì˜ ê°œë³„ í…ŒìŠ¤íŠ¸ë“¤ë¡œ êµ¬ì„±í•  ìˆ˜ ìˆë‹¤.
2. ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ê°€ ê°€ëŠ¥í•œ ì»´í¬ë„ŒíŠ¸ë¥¼ ì„¤ê³„í•˜ì—¬ ì „ë³´ë‹¤ ì¼ê´€ëœ êµ¬ì¡°ë¥¼ ê°€ì§„ ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬ë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤.

### Container-Presenter íŒ¨í„´

![Container-Presenter](./images/container_presenter.png)

Container-Presenter íŒ¨í„´ì„ ì°¸ê³ í•˜ì—¬ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ëŒ€ìƒ ì»´í¬ë„ŒíŠ¸ë“¤ì€ Presenterê°€ ë˜ë„ë¡ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

Presenterì— ëŒ€í•´ì„œ í…ŒìŠ¤íŠ¸ë¥¼ êµ¬ì„±í•˜ë©´ í…ŒìŠ¤íŠ¸ ë²”ìœ„ë¥¼ ì»´í¬ë„ŒíŠ¸ì˜ íŠ¹ì • ìƒíƒœì—ì„œ ë Œë”ë§ì´ ì œëŒ€ë¡œ ì¼ì–´ë‚¬ëŠ”ì§€ ì—¬ë¶€ì™€ ë‹¤ë¥¸ ìƒíƒœë¡œ ë³€í–ˆì„ ë•Œ ì˜¬ë°”ë¥¸ eventê°€ emitë˜ì—ˆëŠ”ì§€ ì—¬ë¶€ë¡œ ì¢í ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬ ëª¨ë¸

ë¦¬íŒ©í† ë§ì„ ì ìš©í–ˆì„ ë•Œ ì˜ˆìƒí–ˆë˜ ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬ëŠ” ì•„ë˜ì™€ ê°™ì´ ë‹¤ì´ì–´ê·¸ë¨ìœ¼ë¡œ ê·¸ë ¸ìŠµë‹ˆë‹¤.

![Component Tree](./images/component_tree.png)

`CatalogEditor`ëŠ” ìƒì„¸í˜ì´ì§€ì—ì„œ ë¦¬íŒ©í† ë§ ëŒ€ìƒì´ ë˜ëŠ” í˜ì´ì§€ ì„¹ì…˜ì— í•´ë‹¹í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ì´ê³  2ê°œì˜ íƒ­ì¸ `MainTab`ê³¼ `BuycdtTab`ìœ¼ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤.

:::info
ìœ„ì—ì„œ ë¶‰ì€ìƒ‰ìœ¼ë¡œ ì»´í¬ë„ŒíŠ¸ ì˜ì—­ë“¤ì„ í‘œì‹œí•œ ì´ë¯¸ì§€ëŠ” `MainTab`ì—ì„œ ìº¡ì³í•œ ê²ë‹ˆë‹¤.
:::

ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ëŒ€ìƒì´ ë˜ëŠ” ì»´í¬ë„ŒíŠ¸ëŠ” "Row"ë¼ëŠ” postfixë¥¼ ê°€ì§„ Presenter, `CatalogEditor`ì™€ ë‘ íƒ­ì€ ëª¨ë‘ Container ì—­í• ì„ ê°€ì§‘ë‹ˆë‹¤.

`CatalogEditor`ëŠ” API í˜¸ì¶œë¡œ Presenterë“¤ì˜ ì´ˆê¸° ìƒíƒœê°’ì„ ì¡°íšŒí•˜ê±°ë‚˜ ìˆ˜ì •í•œ ìƒì„¸ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” ë“±ì˜ ì¼ê´„ì‘ì—…ë“¤ì„ ë‹´ë‹¹í•˜ê³  [provide/inject](https://vuejs.org/guide/components/provide-inject.html)ë¥¼ í†µí•´ Presenterì™€ ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ìŠµë‹ˆë‹¤.

íƒ­ì€ Presenterë§ˆë‹¤ í•„ìš”í•œ ìƒíƒœê´€ë¦¬ ë¡œì§ë“¤ì„ ë‹´ì€ í•¨ìˆ˜ë“¤ì´ ìœ„ì¹˜í•œ ì˜ì—­ìœ¼ë¡œ Presenterì—ì„œ emití•œ eventë¥¼ ê°ì§€í•˜ì—¬ í•„ìš”í•œ dispatchë“¤ì„ ìˆ˜í–‰í•˜ê³  ì—…ë°ì´íŠ¸ëœ ìƒíƒœê°’(dependency)ë“¤ì„ propsë¥¼ í†µí•´ Presenterë¡œ ì „ë‹¬í•©ë‹ˆë‹¤.

## ì‹œë‚˜ë¦¬ì˜¤ ì‘ì„±

`MainTab`ì˜ `CategoryRow`ë¥¼ ê°œë°œí•˜ê¸°ì— ì•ì„œì„œ í•´ë‹¹ ì»´í¬ë„ŒíŠ¸ì˜ ê¸°ëŠ¥ê³¼ ê´€ë ¨ëœ ì •ì±…ë“¤ì„ íŒŒì•…í•˜ê¸° ìœ„í•´ ì‚¬ìš©ì ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.

![CategoryRow](./images/categoryRow.png)

ê·¸ë¦¬ê³  ìœ„ ì‹œë‚˜ë¦¬ì˜¤ì™€ ê¸°ì¡´ ì†ŒìŠ¤ì˜ ë¡œì§ì„ ë°”íƒ•ìœ¼ë¡œ `CategoryRow`ì—ì„œ í™•ì¸í•  ì‚¬í•­ë“¤ì„ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤.

![CategoryRow Tests](./images/categoryRow_tests.png)

## ì»´í¬ë„ŒíŠ¸ êµ¬í˜„

ì´ì œ ì°¨ë¡€ëŒ€ë¡œ Containerì™€ Presenterë“¤ì„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

### CatalogEditor

```html
<template>
  <div class="q-ma-md relative-position">
    <!-- íƒ­ ë° ì¹´íƒˆë¡œê·¸ ì €ì¥/ì‚­ì œ ë²„íŠ¼ë“¤ ì˜ì—­ -->
    <MainTab />
    <!-- BuycdtTab -->
  </div>
</template>
<script lang="ts">
  import { defineComponent, provide } from "@vue/compostion-api";
  import MainTab from "@/components/catalog/detail/MainTab.vue";
  import { CTLG_CATE_IK } from "@/constants/catalog/detail/keys";
  // ...

  export default defineComponent({
    name: "CatalogEditor",
    components: {
      MainTab,
    },
    setup(props, context) {
      // ...

      // rowë³„ ì´ˆê¸° ìƒíƒœê°’(ctlgCate)ì„ í•˜ìœ„ ì»´í°ë„ŒíŠ¸ë“¤ë¡œ provideí•©ë‹ˆë‹¤.
      // CTLG_CATE_IK => symbol íƒ€ì…ì„ ê°€ì§€ëŠ” provide key
      provide(CTLG_CATE_IK, ctlgCate);
    },
  });
</script>
```

### MainTab

```html
<template>
  <q-markup-table>
    <tbody>
      <CategoryRow
        v-bind="{ allCategories, catePerDepth }"
        @update:allCategories="onUpdateAllCategories"
        @update:nextDepth="onUpdateNextDepth"
      />
      <!-- ê·¸ì™¸ì˜ Rowë“¤ -->
    </tbody>
  </q-markup-table>
</template>
<script lang="ts">
  import { defineComponent } from "@vue/composition-api";
  import CategoryRow from "@/components/catalog/detail/CategoryRow";
  // CategoryRowì—ì„œ í•„ìš”í•œ ìƒíƒœê°’ê³¼ ë¡œì§ë“¤ì´ ì •ì˜ëœ í•¨ìˆ˜
  import useCategoryRow from "@/components/catalog/detail/CategoryRow/hooks";
  // ...

  export default defineComponent({
    name: "MainTab",
    components: {
      CategoryRow,
    },
    setup(props, context) {
      const {
        allCategories,
        catePerDepth,
        onUpdateAllCategories,
        onUpdateNextDepth,
      } = useCategoryRow();
      // ...
      return {
        allCategories,
        catePerDepth,
        onUpdateAllCategories,
        onUpdateNextDepth,
        // ...
      };
    },
  });
</script>
```

### CategoryRow

```html
<template>
  <tr>
    <th>ì¹´í…Œê³ ë¦¬<span class="required-mark" /></th>
    <td colspan="5">
      <!-- ì¹´í…Œê³ ë¦¬ ê²€ìƒ‰ì˜ì—­ -->
      <div class="q-mb-lg full-width">
        <q-select
          ref="$qSelect"
          v-model="selectedItem"
          :options="searchOptions"
          @input="onSelected"
          @filter="filterSearchResult"
          @keyup.stop="onKeyup"
        />
      </div>
      <!-- depth1 ~ depth4ê¹Œì§€ ì¹´í…Œê³ ë¦¬ ì„ íƒì˜ì—­-->
      <div class="q-mb-lg">
        <q-select
          v-for="(depth, index) in ['depth1', 'depth2', 'depth3', 'depth4']"
          :key="depth"
          v-model="cateState[depth]"
          :options="optionsPerDepth[depth]"
          :disable="isDisable(i + 1)"
          :label="depth"
          @input="onChangeDepth($event, i + 1)"
        />
      </div>
      <div>ì„ íƒ ì¹´í…Œê³ ë¦¬: {{ fullCateText }}</div>
    </td>
  </tr>
</template>
<script lang="ts">
  import { defineComponent, PropType, inject } from "@vue/composition-api";
  // ì¹´í…Œê³ ë¦¬ ê²€ìƒ‰ì˜ì—­ì—ì„œ ì‚¬ìš©í•  ìƒíƒœê°’ë“¤ê³¼ ë¡œì§ë“¤ì„ ì •ì˜í•œ í•¨ìˆ˜
  import useSearchInput from "@/components/catalog/detail/CategoryRow/hooks/useSearchInput";
  // depthë³„ ì¹´í…Œê³ ë¦¬ ì„ íƒì˜ì—­ì—ì„œ ì‚¬ìš©í•  ìƒíƒœê°’ë“¤ê³¼ ë¡œì§ë“¤ì„ ì •ì˜í•œ í•¨ìˆ˜
  import useCateDepth from "@/components/catalog/detail/CategoryRow/hooks/useCateDepth";
  // ...

  export default defineComponent({
    name: "CategoryRow",
    props: {
      allCategories: Array as PropType<CommonCategory[]>,
      cateDepth: [Number, Array] as unknown as PropType<[number, CateInfo[]]>,
    },
    setup(props, context) {
      // CatalogEditorë¡œë¶€í„° provideëœ ë°ì´í„°ë¥¼ inject
      const ctlgCate = inject(CTLG_CATE_IK);

      const {
        searchOptions,
        $qSelect,
        selectedItem,
        onKeyup,
        filterSearchResult,
      } = useSearchInput();

      const {
        cateState,
        optionsPerDepth,
        fullCateText,
        isDisable,
        onChangeDepth,
      } = useCateDepth();

      // ...

      return {
        searchOptions,
        $qSelect,
        selectedItem,
        onKeyup,
        filterSearchResult,
        cateState,
        optionsPerDepth,
        fullCateText,
        isDisable,
        onChangeDepth,
        // ...
      };
    },
  });
</script>
```

## í…ŒìŠ¤íŠ¸

### setup

í…ŒìŠ¤íŠ¸ ì½”ë“œëŠ” Jest ê¸°ë°˜ì˜ Vue ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ì¸ [vue-test-utils](https://v1.test-utils.vuejs.org/)ë¡œ ì‘ì„±í–ˆê³ , í”„ë¡œì íŠ¸ root levelì— ìˆëŠ” `__test__` í´ë” ë‚´ì— Rowë³„ë¡œ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤.

```text
__test__
â”œ- CategoryRow
|  â”œ- index.test.ts
|  â”œ- mocks.ts
|
â”œ- ManufactureRow
|  â”œ- index.test.ts
|  â”œ- mocks.ts
|
â”œ- ...
â”œ- setup.ts
```

ë¨¼ì € í…ŒìŠ¤íŠ¸ ìƒì—ì„œ Quasarë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì•„ë˜ì™€ ê°™ì´ setup ì½”ë“œë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.

```ts
// /__test__/setup.ts
import Vue from "vue";
import VueCompositionApi from "@vue/composition-api";
import Quasar from "quasar";

Object.defineProperty(document, "doctype", { value: "<!DOCTYPE html>" });

Vue.use(VueCompositionApi);
Vue.use(Quasar);
```

ê·¸ë¦¬ê³  mock ë°ì´í„°ë„ ë¯¸ë¦¬ ì¤€ë¹„í•´ë‘¡ë‹ˆë‹¤.

```ts
// /__test__/CategoryRow/mocks
export const ALL_CATEGORIES = [
  {
    cateCd: 1100000,
    cateNm: "ê°€ê³µì‹í’ˆ",
    fullNm: "ê°€ê³µì‹í’ˆ",
    childCategories: [2100000],
  },
  {
    cateCd: 2100000,
    cateNm: "ê³¼ì/ë² ì´ì»¤ë¦¬/ë–¡",
    fullNm: "ê°€ê³µì‹í’ˆ > ê³¼ì/ë² ì´ì»¤ë¦¬/ë–¡",
    childCategories: [3100001],
  },
  {
    cateCd: 3100001,
    cateNm: "ë–¡/í•œê³¼",
    fullNm: "ê°€ê³µì‹í’ˆ > ê³¼ì/ë² ì´ì»¤ë¦¬/ë–¡ > ë–¡/í•œê³¼",
    childCategories: [4100010, 4100011],
  },
  {
    cateCd: 4100010,
    cateNm: "ë§Œì¥¬/í™”ê³¼ì",
    fullNm: "ê°€ê³µì‹í’ˆ > ê³¼ì/ë² ì´ì»¤ë¦¬/ë–¡ > ë–¡/í•œê³¼ > ë§Œì¥¬/í™”ê³¼ì",
    childCategories: [],
  },
  {
    cateCd: 4100011,
    cateNm: "ì´ì™¸ ë–¡/í•œê³¼ë¥˜",
    fullNm: "ê°€ê³µì‹í’ˆ > ê³¼ì/ë² ì´ì»¤ë¦¬/ë–¡ > ë–¡/í•œê³¼ > ì´ì™¸ ë–¡/í•œê³¼ë¥˜",
    childCategories: [],
  },
  // ...
];
export const CATE_PER_DEPTH = {
  depth1: [
    1,
    [
      { cateCd: 1100093, cateNm: "í”„ë¡ íŠ¸ì—”ë“œëŒ€ë¶„ë¥˜" },
      // ...
    ],
  ],
  depth2: [
    2,
    [
      { cateCd: 2000857, cateNm: "í”„ë¡ íŠ¸ì—”ë“œì¤‘ë¶„ë¥˜1" },
      { cateCd: 2000858, cateNm: "í”„ë¡ íŠ¸ì—”ë“œì¤‘ë¶„2" },
      // ...
    ],
  ],
  depth3: [
    3,
    [
      { cateCd: 3007283, cateNm: "í”„ë¡ íŠ¸ì—”ë“œì†Œë¶„ë¥˜1-1" },
      { cateCd: 3007284, cateNm: "í”„ë¡ íŠ¸ì—”ë“œì†Œë¶„ë¥˜1-2" },
      // ...
    ],
  ],
  depth4: [
    4,
    [
      { cateCd: 4013259, cateNm: "í”„ë¡ íŠ¸ì—”ë“œ1-1-ì„¸ë¶„ë¥˜1" },
      // ...
    ],
  ],
};
```

### TC ì‘ì„±

```ts
// /__test__/CategoryRow/index.test.ts
import { mount } from "@vue/test-utils";
import CategoryRow from "@/components/catalog/detail/CategoryRow";
import { QSelect } from "quasar";
import { ALL_CATEGORIES, CATE_PER_DEPTH } from "./mocks";

let wrapper, searchInput, depth1Input, depth2Input, depth3Input;

// test í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•  ë•Œë§ˆë‹¤ CategoryRow ì»´í¬ë„ŒíŠ¸ë¥¼ mountí•˜ì—¬ ìƒíƒœë¥¼ ì´ˆê¸°í™”ì‹œí‚µë‹ˆë‹¤.
beforeEach(() => {
  wrapper = mount(CategoryRow);
  searchInput = wrapper.findAllComponents(QSelect).at(0);
  depth1Input = wrapper.findAllComponents(QSelect).at(1);
  depth2Input = wrapper.findAllComponents(QSelect).at(2);
  depth3Input = wrapper.findAllComponents(QSelect).at(3);
});

desccribe("mount ê´€ë ¨ í…ŒìŠ¤íŠ¸", () => {
  test("ì»´í¬ë„ŒíŠ¸ê°€ ì •ìƒì ìœ¼ë¡œ mountë˜ì—ˆëŠ”ê°€?", () => {
    expect(wrapper.exists()).toBeTruthy();
  });
  test("ë‚´ë¶€ Quasar ì»´í¬ë„ŒíŠ¸ë“¤ ëª¨ë‘ ê°œìˆ˜ì— ë§ê²Œ mountë˜ì—ˆëŠ”ê°€?", () => {
    expect(wrapper.findAllComponents(QSelect)).toHaveLength(5);
  });
  test("mount ì¤‘ update:allCategories ì´ë²¤íŠ¸ê°€ emitë˜ì—ˆëŠ”ê°€?", () => {
    expect(wrapper.emitted("update:allCategories")).toBeTruthy();
  });
  test("mount ì¤‘ update:nextDepth ì´ë²¤íŠ¸ê°€ payloadì™€ í•¨ê»˜ emitë˜ì—ˆëŠ”ê°€?", () => {
    expect(wrapper.emitted("update:nextDepth")[0]).toEqual([
      { cateDepth: 1, prtCateCd: 0 },
    ]);
  });
});

describe("ê²€ìƒ‰ì°½ ê´€ë ¨ í…ŒìŠ¤íŠ¸", () => {
  test("ê²€ìƒ‰ì°½ì— ì…ë ¥ì´ ê°€ëŠ¥í•œê°€?", async () => {
    const searchInputEl = searchInput.find('input[type="search"]');
    await searchInputEl.setValue("ê°€ê³µ");
    expect(searchInputEl.element.value).toEqual("ê°€ê³µ");
  });
});

describe("Ndepth ì…ë ¥í•„ë“œ ê´€ë ¨ í…ŒìŠ¤íŠ¸", () => {
  test("ê²€ìƒ‰ì°½ì˜ í•˜ë‹¨ ë¦¬ìŠ¤íŠ¸ í•­ëª©ì„ ì„ íƒí•˜ë©´ depthë³„ ì¹´í…Œê³ ë¦¬ ì •ë³´ê°€ ì ì ˆíˆ ì—…ë°ì´íŠ¸ë˜ëŠ”ê°€?", async () => {
    await wrapper.setProps({ allCategories: ALL_CATEGORIES });
    const selectedItem = wrapper
      .props("allCategories")
      .find(({ cateCd }) => cateCd === 4100010);
    // ê²€ìƒ‰ê²°ê³¼ ë¦¬ìŠ¤íŠ¸ì—ì„œ depth4 í•­ëª©(cateCd=4100010)ì„ ì„ íƒí•˜ë©´
    searchInput.vm.$emit("input", selectedItem);
    await wrapper.vm.$nextTick();
    // cateCd=1100000ì¸ depth1 í•­ëª©ì´ ë…¸ì¶œë˜ëŠ”ê°€?
    expect(wrapper.emitted("update:nextDepth")[1]).toEqual([
      { cateDepth: 2, prtCateCd: 1100000 },
    ]);
    // cateCd=2100000ì¸ depth2 í•­ëª©ì´ ë…¸ì¶œë˜ëŠ”ê°€?
    expect(wrapper.emitted("update:nextDepth")[2]).toEqual([
      { cateDepth: 3, prtCateCd: 2100000 },
    ]);
    // cateCd=3100001ì¸ depth3 í•­ëª©ì´ ë…¸ì¶œë˜ëŠ”ê°€?
    expect(wrapper.emitted("update:nextDepth")[3]).toEqual([
      { cateDepth: 4, prtCateCd: 3100001 },
    ]);
  });
  test("depthN í•„ë“œì—ì„œ ì„ì˜ì˜ í•­ëª©ì„ ì„ íƒí•˜ë©´ depth(N+1) í•„ë“œì˜ ì¹´í…Œê³ ë¦¬ ë¦¬ìŠ¤íŠ¸ê°€ ì—…ë°ì´íŠ¸ë˜ëŠ”ê°€?", async () => {
    let depthOptions;
    // depth1 í•„ë“œì—ì„œ "í”„ë¡ íŠ¸ì—”ë“œëŒ€ë¶„ë¥˜"(cateCd=1100093)ë¥¼ ì„ íƒí•˜ëŠ” ê²½ìš°
    await wrapper.setProps({ catePerDepth: CATE_PER_DEPTH["depth1"] });
    depthOptions = wrapper.vm.$data.optionsPerDepth["depth1"];
    expect(depthOptions.length).toEqual(1);
    depth1Input.vm.$emit("input", depthOptions[0]);
    await wrapper.vm.$nextTick();
    expect(wrapper.emitted("update:nextDepth")[1]).toEqual([
      { cateDepth: 2, prtCateCd: 1100093 },
    ]);
    // depth2 í•„ë“œì—ì„œ "í”„ë¡ íŠ¸ì—”ë“œì¤‘ë¶„ë¥˜1"(cateCd=2000857)ë¥¼ ì„ íƒí•˜ëŠ” ê²½ìš°
    await wrapper.setProps({ catePerDepth: CATE_PER_DEPTH["depth2"] });
    depthOptions = wrapper.vm.$data.optionsPerDepth["depth2"];
    expect(depthOptions.length).toEqual(4);
    depth2Input.vm.$emit("input", depthOptions[0]);
    await wrapper.vm.$nextTick();
    expect(wrapper.emitted("update:nextDepth")[2]).toEqual([
      { cateDepth: 3, prtCateCd: 2000857 },
    ]);
    // depth3 í•„ë“œì—ì„œ "í”„ë¡ íŠ¸ì—”ë“œì†Œë¶„ë¥˜1-1"(cateCd=3007283)ì„ ì„ íƒí•˜ëŠ” ê²½ìš°
    await wrapper.setProps({ catePerDepth: CATE_PER_DEPTH["depth3"] });
    depthOptions = wrapper.vm.$data.optionsPerDepth["depth3"];
    expect(depthOptions.length).toEqual(3);
    depth3Input.vm.$emit("input", depthOptions[0]);
    await wrapper.vm.$nextTick();
    expect(wrapper.emitted("update:nextDepth")[3]).toEqual([
      { cateDepth: 4, prtCateCd: 3007283 },
    ]);
  });
});
```

ì´ì œ ì‹¤í–‰í•´ë³´ë©´ ì•„ë˜ì™€ ê°™ì´ ì œëŒ€ë¡œ ì‹¤í–‰í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![Test Result](./images/test_result.png)

## ë§ˆë¬´ë¦¬

ë‹¹ì‹œ ë¦¬íŒ©í† ë§ì„ ì§„í–‰í•˜ë©´ì„œ ì‹œë‚˜ë¦¬ì˜¤ì™€ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ” ê²ƒì€ í”„ë¡œì íŠ¸ íˆìŠ¤í† ë¦¬ ê´€ë¦¬ì™€ side-effectì—†ì´ featureë¥¼ êµ¬í˜„í•˜ëŠ”ë°ì— ë„ì›€ì´ ëœë‹¤ê³  ëŠê¼ˆìŠµë‹ˆë‹¤.

í•˜ì§€ë§Œ ë‹¤ì‹œ ëŒì•„ë³´ë©´ Presenter ì»´í¬ë„ŒíŠ¸ë¥¼ í…ŒìŠ¤íŠ¸ ë‹¨ìœ„ë¡œ í•˜ëŠ” ê²ƒì´ ê³¼ì—° ì´ ì˜ì˜ì— ë¶€í•©í•œ ë°©ì‹ì¸ì§€ ì˜ë¬¸ì´ ë“­ë‹ˆë‹¤.

íŠ¹ì • ê¸°ëŠ¥ì´ ì œëŒ€ë¡œ ë™ì‘í•˜ë©´ì„œ ë‚´ë¶€ ìƒíƒœê°’ì´ ì˜¬ë°”ë¥´ê²Œ ë™ê¸°í™”ë˜ëŠ”ì§€ ì—¬ë¶€ë¥¼ íŒë‹¨í•˜ëŠ”ë° propsì˜ ê°’ê³¼ emitëœ eventë“¤ì˜ ì¢…ë¥˜ë§Œìœ¼ë¡œëŠ” ê·¼ê±°ê°€ ë¶€ì¡±í•˜ì§€ ì•Šë‚˜ ì‹¶ìŠµë‹ˆë‹¤.

ê·¸ë¦¬ê³  í…ŒìŠ¤íŠ¸ê°€ ê°€ëŠ¥í•œ ë°©í–¥ìœ¼ë¡œë§Œ ì»´í¬ë„ŒíŠ¸ë¥¼ ì„¤ê³„í•˜ëŠ” ë°©ì‹ì´ ì„ì˜ì˜ ìš”êµ¬ì‚¬í•­ë“¤ì„ êµ¬í˜„í•˜ëŠ”ë° ê±¸ë¦¼ëŒì´ ë  ìˆ˜ë„ ìˆë‹¤ëŠ” ìƒê°ë„ ë“­ë‹ˆë‹¤.

íŠ¹íˆ ë°±ì˜¤í”¼ìŠ¤ ê°™ì´ ì‚¬ìš©ìê°€ ì„ íƒí•œ ì˜µì…˜ì— ë”°ë¼ì„œ ì¼ë¶€ í•„ë“œë“¤ì˜ ê°’ë¿ë§Œ ì•„ë‹ˆë¼ í™”ë©´ì— ë Œë”ë§ë˜ì§€ë„ ì•Šì€ íƒ­ì˜ ì»¨í…ì¸ ê°€ ë‹¬ë¼ì§€ê±°ë‚˜ ë¹„í™œì„±í™”ë˜ëŠ” ë“±ì˜ ë³„ì˜ë³„ ìƒí˜¸ì‘ìš©ì„ ìš”êµ¬í•˜ëŠ” ì„œë¹„ìŠ¤ì˜ ê²½ìš°, Presenter ë‹¨ìœ„ë¡œë§Œ ì»´í¬ë„ŒíŠ¸ë¥¼ êµ¬ì„±í•˜ëŠ” ê²ƒì€ ëœ ìœ ì—°í•œ ë°©ì‹ì¼ê²ë‹ˆë‹¤.

ì˜¬ë°”ë¥¸ í…ŒìŠ¤íŠ¸ ë‹¨ìœ„ ì°¾ì„ ë•Œê¹Œì§€ ê³„ì† ê³µë¶€ë¥¼ í•´ì•¼ê² êµ°ìš”ğŸ¤”

## ì°¸ê³ ìë£Œ

[2 Ways to Write Easily Testable React Components](https://brettfisher.dev/better-testing/)

[ë°”ë‹¥ë¶€í„° ì‹œì‘í•˜ëŠ” Vue ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸](https://tech.kakao.com/2019/11/27/kakao-business-vue-component-test/)

[Writing testable React components with hooks](https://charles-stover.medium.com/writing-testable-react-components-with-hooks-23441ee582d5)
